{"ast":null,"code":"\"use strict\";\n\nfunction _classPrivateMethodInitSpec(obj, privateSet) {\n  _checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\n  if (privateCollection.has(obj)) {\n    throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n  }\n}\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\n  if (!privateSet.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n  return fn;\n}\nconst Config = require('./webcastConfig.js');\nconst websocket = require('websocket');\nconst {\n  deserializeWebsocketMessage,\n  serializeMessage\n} = require('./webcastProtobuf.js');\nvar _handleEvents = /*#__PURE__*/new WeakSet();\nvar _handleMessage = /*#__PURE__*/new WeakSet();\nvar _sendPing = /*#__PURE__*/new WeakSet();\nvar _sendAck = /*#__PURE__*/new WeakSet();\nclass WebcastWebsocket extends websocket.client {\n  constructor(wsUrl, cookieJar, clientParams, wsParams, customHeaders, websocketOptions) {\n    super();\n    _classPrivateMethodInitSpec(this, _sendAck);\n    _classPrivateMethodInitSpec(this, _sendPing);\n    _classPrivateMethodInitSpec(this, _handleMessage);\n    _classPrivateMethodInitSpec(this, _handleEvents);\n    this.pingInterval = null;\n    this.connection = null;\n    this.wsParams = {\n      ...clientParams,\n      ...wsParams\n    };\n    this.wsUrlWithParams = `${wsUrl}?${new URLSearchParams(this.wsParams)}`;\n    this.wsHeaders = {\n      Cookie: cookieJar.getCookieString(),\n      ...(customHeaders || {})\n    };\n    _classPrivateMethodGet(this, _handleEvents, _handleEvents2).call(this);\n    this.connect(this.wsUrlWithParams, '', Config.TIKTOK_URL_WEB, this.wsHeaders, websocketOptions);\n  }\n}\nfunction _handleEvents2() {\n  this.on('connect', wsConnection => {\n    this.connection = wsConnection;\n    this.pingInterval = setInterval(() => _classPrivateMethodGet(this, _sendPing, _sendPing2).call(this), 10000);\n    wsConnection.on('message', message => {\n      if (message.type === 'binary') {\n        _classPrivateMethodGet(this, _handleMessage, _handleMessage2).call(this, message);\n      }\n    });\n    wsConnection.on('close', () => {\n      clearInterval(this.pingInterval);\n    });\n  });\n}\nasync function _handleMessage2(message) {\n  try {\n    let decodedContainer = await deserializeWebsocketMessage(message.binaryData);\n    if (decodedContainer.id > 0) {\n      _classPrivateMethodGet(this, _sendAck, _sendAck2).call(this, decodedContainer.id);\n    } // Emit 'WebcastResponse' from ws message container if decoding success\n\n    if (typeof decodedContainer.webcastResponse === 'object') {\n      this.emit('webcastResponse', decodedContainer.webcastResponse);\n    }\n  } catch (err) {\n    this.emit('messageDecodingFailed', err);\n  }\n}\nfunction _sendPing2() {\n  // Send static connection alive ping\n  this.connection.sendBytes(Buffer.from('3A026862', 'hex'));\n}\nfunction _sendAck2(id) {\n  let ackMsg = serializeMessage('WebcastWebsocketAck', {\n    type: 'ack',\n    id\n  });\n  this.connection.sendBytes(ackMsg);\n}\nmodule.exports = WebcastWebsocket;","map":{"version":3,"names":["_classPrivateMethodInitSpec","obj","privateSet","_checkPrivateRedeclaration","add","privateCollection","has","TypeError","_classPrivateMethodGet","receiver","fn","Config","require","websocket","deserializeWebsocketMessage","serializeMessage","_handleEvents","WeakSet","_handleMessage","_sendPing","_sendAck","WebcastWebsocket","client","constructor","wsUrl","cookieJar","clientParams","wsParams","customHeaders","websocketOptions","pingInterval","connection","wsUrlWithParams","URLSearchParams","wsHeaders","Cookie","getCookieString","_handleEvents2","call","connect","TIKTOK_URL_WEB","on","wsConnection","setInterval","_sendPing2","message","type","_handleMessage2","clearInterval","decodedContainer","binaryData","id","_sendAck2","webcastResponse","emit","err","sendBytes","Buffer","from","ackMsg","module","exports"],"sources":["/Users/gustavnielsen/Documents/Kode.nosync/tiktokgame/node_modules/tiktok-live-connector/dist/lib/webcastWebsocket.js"],"sourcesContent":["\"use strict\";\n\nfunction _classPrivateMethodInitSpec(obj, privateSet) { _checkPrivateRedeclaration(obj, privateSet); privateSet.add(obj); }\n\nfunction _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\n\nfunction _classPrivateMethodGet(receiver, privateSet, fn) { if (!privateSet.has(receiver)) { throw new TypeError(\"attempted to get private field on non-instance\"); } return fn; }\n\nconst Config = require('./webcastConfig.js');\n\nconst websocket = require('websocket');\n\nconst {\n  deserializeWebsocketMessage,\n  serializeMessage\n} = require('./webcastProtobuf.js');\n\nvar _handleEvents = /*#__PURE__*/new WeakSet();\n\nvar _handleMessage = /*#__PURE__*/new WeakSet();\n\nvar _sendPing = /*#__PURE__*/new WeakSet();\n\nvar _sendAck = /*#__PURE__*/new WeakSet();\n\nclass WebcastWebsocket extends websocket.client {\n  constructor(wsUrl, cookieJar, clientParams, wsParams, customHeaders, websocketOptions) {\n    super();\n\n    _classPrivateMethodInitSpec(this, _sendAck);\n\n    _classPrivateMethodInitSpec(this, _sendPing);\n\n    _classPrivateMethodInitSpec(this, _handleMessage);\n\n    _classPrivateMethodInitSpec(this, _handleEvents);\n\n    this.pingInterval = null;\n    this.connection = null;\n    this.wsParams = { ...clientParams,\n      ...wsParams\n    };\n    this.wsUrlWithParams = `${wsUrl}?${new URLSearchParams(this.wsParams)}`;\n    this.wsHeaders = {\n      Cookie: cookieJar.getCookieString(),\n      ...(customHeaders || {})\n    };\n\n    _classPrivateMethodGet(this, _handleEvents, _handleEvents2).call(this);\n\n    this.connect(this.wsUrlWithParams, '', Config.TIKTOK_URL_WEB, this.wsHeaders, websocketOptions);\n  }\n\n}\n\nfunction _handleEvents2() {\n  this.on('connect', wsConnection => {\n    this.connection = wsConnection;\n    this.pingInterval = setInterval(() => _classPrivateMethodGet(this, _sendPing, _sendPing2).call(this), 10000);\n    wsConnection.on('message', message => {\n      if (message.type === 'binary') {\n        _classPrivateMethodGet(this, _handleMessage, _handleMessage2).call(this, message);\n      }\n    });\n    wsConnection.on('close', () => {\n      clearInterval(this.pingInterval);\n    });\n  });\n}\n\nasync function _handleMessage2(message) {\n  try {\n    let decodedContainer = await deserializeWebsocketMessage(message.binaryData);\n\n    if (decodedContainer.id > 0) {\n      _classPrivateMethodGet(this, _sendAck, _sendAck2).call(this, decodedContainer.id);\n    } // Emit 'WebcastResponse' from ws message container if decoding success\n\n\n    if (typeof decodedContainer.webcastResponse === 'object') {\n      this.emit('webcastResponse', decodedContainer.webcastResponse);\n    }\n  } catch (err) {\n    this.emit('messageDecodingFailed', err);\n  }\n}\n\nfunction _sendPing2() {\n  // Send static connection alive ping\n  this.connection.sendBytes(Buffer.from('3A026862', 'hex'));\n}\n\nfunction _sendAck2(id) {\n  let ackMsg = serializeMessage('WebcastWebsocketAck', {\n    type: 'ack',\n    id\n  });\n  this.connection.sendBytes(ackMsg);\n}\n\nmodule.exports = WebcastWebsocket;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}